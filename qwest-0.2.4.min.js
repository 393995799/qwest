this.qwest=function(){var qwest=function(method,url,data,options){data=data||null;options=options||{};var win=window,typeSupported=false,xhr=win.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),version2=xhr.responseType==="",async=options.async===undefined?true:!!options.async,cache=options.cache===undefined?true:!!options.cache,type=options.type?options.type.toLowerCase():"json",user=options.user||"",password=options.password||"",headers=options.headers||[],vars="",i,contentType="Content-Type",requestedWith="X-Requested-With",parseError="parseError",serialized,success_stack=[],error_stack=[],complete_stack=[],response,success,error,func,promises={success:function(func){if(async){success_stack.push(func)}else if(success){func.apply(xhr,[response])}return promises},error:function(func){if(async){error_stack.push(func)}else if(error){func.apply(xhr,[response])}return promises},complete:function(func){if(async){complete_stack.push(func)}else{func.apply(xhr)}return promises}},handleResponse=function(){var i;try{if(xhr.status!=200){throw xhr.status+" ("+xhr.statusText+")"}var responseText=xhr.responseText,responseXML="responseXML";if(type=="text"){response=responseText}else if(typeSupported&&xhr.response!==undefined){response=xhr.response}else{switch(type){case"json":try{if(win.JSON){response=win.JSON.parse(responseText)}else{response=eval("("+responseText+")")}}catch(e){throw"Error while parsing JSON body"}break;case"js":response=eval(responseText);break;case"xml":if(!xhr[responseXML]||xhr[responseXML][parseError]&&xhr[responseXML][parseError].errorCode&&xhr[responseXML][parseError].reason){throw"Error while parsing XML body"}else{response=xhr[responseXML]}break;default:throw"Unsupported "+type+" type"}}success=true;if(async){for(i=0;func=success_stack[i];++i){func.apply(xhr,[response])}}}catch(e){error=true;response="Request to '"+url+"' aborted: "+e;if(async){for(i=0;func=error_stack[i];++i){func.apply(xhr,[response])}}}if(async){for(i=0;func=complete_stack[i];++i){func.apply(xhr)}}};if(type&&version2){xhr.responseType=type;typeSupported=xhr.responseType==type}if(data instanceof ArrayBuffer||data instanceof Blob||data instanceof Document||data instanceof FormData){if(method=="GET"){data=null}}else{var values=[],enc=encodeURIComponent;for(i in data){values.push(enc(i)+"="+enc(data[i]))}data=values.join("&");serialized=true}if(method=="GET"){vars+=data}if(cache){if(vars){vars+="&"}vars+="t="+Date.now()}if(vars){url+=(/\?/.test(url)?"&":"?")+vars}xhr.open(method,url,async,user,password);if(version2){xhr.onload=handleResponse}else{xhr.onreadystatechange=function(){if(xhr.readyState==4){handleResponse()}}}if(serialized&&method=="POST"&&!headers[contentType]){headers[contentType]="application/x-www-form-urlencoded"}if(!headers[requestedWith]){headers[requestedWith]="XMLHttpRequest"}for(i in headers){xhr.setRequestHeader(i,headers[i])}xhr.send(method=="POST"?data:null);return promises};return{get:function(url,data,options){return qwest("GET",url,data,options)},post:function(url,data,options){return qwest("POST",url,data,options)}}}();